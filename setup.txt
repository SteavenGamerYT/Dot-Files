# Basic Packages
pacman -S base base-devel git linux-vfio-lts linux-vfio-lts-headers linux-firmware efibootmgr plymouth mkinitcpio-firmware
systemctl enable fstrim.timer

# Start Packages
pacman -S bash-completion kitty paru

# Time/Date/Clock
ln -sf /usr/share/zoneinfo/Africa/Cairo /etc/localtime
hwclock --systohc
systemctl enable systemd-timesyncd

# Language
echo 'LANG=en_US.UTF-8' | tee /etc/locale.conf
sed -i 's/^#\(ar_EG.UTF-8 UTF-8\)/\1/' /etc/locale.gen
sed -i 's/^#\(en_US.UTF-8 UTF-8\)/\1/' /etc/locale.gen
locale-gen

# PC Name
echo "Omar-PC" | tee /etc/hostname

# Create User
useradd -m -G wheel -s /usr/bin/bash omarhanykasban
passwd
passwd omarhanykasban

# Audio
pacman -S pipewire lib32-pipewire helvum pavucontrol pipewire-alsa pipewire-pulse pipewire-jack lib32-pipewire-jack wireplumber alsa-utils pamixer playerctl

# Display Server
pacman -S xorg xorg-server xorg-apps xorg-xinit

# Network
pacman -S networkmanager network-manager-applet
systemctl enable NetworkManager	

# Printer
pacman -S cups foomatic-db-engine foomatic-db foomatic-db-ppds foomatic-db-nonfree foomatic-db-nonfree-ppds gutenprint foomatic-db-gutenprint-ppds hplip epson-inkjet-printer-escpr epson-inkjet-printer-escpr2 system-config-printer
systemctl enable cups

# Disks
pacman -S gnome-disk-utility gparted dosfstools btrfs-progs ntfs-3g exfatprogs mtools

# preload
pacman -S preload
systemctl enable preload

# efibootmgr
efibootmgr --create \
 --disk /dev/nvme0n1 --part 1 \
 --label "Arch Linux" \
 --loader /vmlinuz-linux-vfio-lts \
 --unicode 'root=PARTUUID=44bfa8dd-d6d9-4b93-97e1-ec344d274408 rw splash quiet amd_iommu=on iommu=pt pcie_port_pm=off vfio-pci.ids=1002:6611,1002:aab0 pcie_acs_override=downstream,multifunction video=1920x1080 initrd=\initramfs-linux-vfio-lts.img'

# Eco System
pacman -S openssh syncthing syncthingtray-qt6
systemctl enable sshd
systemctl enable syncthing@omarhanykasban

# Window Manager and its apps
pacman -S i3-wm greetd polybar rofi polkit-gnome nemo nemo-fileroller mpv xdg-desktop-portal-gtk xdg-desktop-portal kwallet kwallet-pam kwallet5 kwalletmanager picom dunst numlockx feh flameshot

# Theme
pacman -S nordic-theme-git lxappearance kvantum kvantum-qt5 papirus-folders papirus-icon-theme qt5ct qt6ct
paru -S whitesur-cursor-theme-git

# Fonts
pacman -S noto-fonts noto-fonts-ar noto-fonts-cjk noto-fonts-emoji ttf-croscore ttf-roboto ttf-roboto-mono ttf-roboto-mono-nerd

# Qemu/KVM 
pacman -S qemu-desktop libvirt edk2-ovmf virt-manager dnsmasq
sudo sed -i 's/#unix_sock_group = "libvirt"/unix_sock_group = "libvirt"/g' /etc/libvirt/libvirtd.conf
sudo sed -i 's/#unix_sock_rw_perms = "0770"/unix_sock_rw_perms = "0770"/g' /etc/libvirt/libvirtd.conf
sudo systemctl enable libvirtd
sudo virsh net-autostart default
sudo virsh net-start default

# Games and its utitls
pacman -S proton-ge-custom wine-staging wine-mono wine-gecko
pacman -S mangohud lib32-mangohud gamemode lib32-gamemode gamescope vulkan-tools protontricks winetricks protonplus 
pacman -S steam lutris heroic-games-launcher-bin
pacman -S duckstation-git rpcs3-git ryujinx cemu-git dolphin-emu pcsx2-git
pacman -S minecraft-launcher prismlauncher lunar-client jre-openjdk jre21-openjdk jre17-openjdk jre8-openjdk 

# Terminal Apps
pacman -S starship zoxide fastfetch trash-cli bat speedtest-cli neovim vim nano unzip unrar neofetch hyfetch xclip lolcat eza github-cli topgrade

# Apps that i use
pacman -S nemo nemo-fileroller 
paru -S nemo-mediainfo-tab
pacman -S bitwarden
paru -S ente-auth-bin
pacman -S discord whatsie-git whatsie-git element-desktop
pacman -S visual-studio-code-bin github-desktop
pacman -S libreoffice-fresh okular kcalc kate phonon-qt6-mpv
pacman -S firefox vlc audacious
pacman -S obs-studio-stable obs-vkcapture lib32-obs-vkcapture gstreamer-vaapi obs-gstreamer v4l2loopback-dkms
paru -S obs-pipewire-audio-capture-bin
pacman -S gimp kdenlive mediainfo mediainfo-gui
pacman -S qbittorrent freedownloadmanager

# Add user to more groups
usermod -a -G wheel,audio,disk,input,kvm,lp,render,storage,uucp,video,gamemode,libvirt omarhanykasban

# Copy desktop files
cp /usr/share/applications/rpcs3.desktop /home/omarhanykasban/.local/share/applications/rpcs3.desktop
cp /usr/share/applications/ryujinx.desktop /home/omarhanykasban/.local/share/applications/ryujinx.desktop
cp /usr/share/applications/duckstation.desktop /home/omarhanykasban/.local/share/applications/duckstation.desktop
cp /usr/share/applications/info.cemu.Cemu.desktop /home/omarhanykasban/.local/share/applications/info.cemu.Cemu.desktop
cp /usr/share/applications/pcsx2.desktop /home/omarhanykasban/.local/share/applications/pcsx2.desktop
cp /usr/share/applications/dolphin-emu.desktop /home/omarhanykasban/.local/share/applications/dolphin-emu.desktop